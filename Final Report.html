<html>

<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Introduction:</title>
</head>

<body>

<p>As has been stated in the description of the practical machine learning project this project consists of data collected from various wearable fitness devices as such as FitBit, JawBone, Nike Fuelband etc.. All this data is categorized as Human Activity Recognition and as a part of this they have tried to qualify instead of quantifying the workouts being performed by the users. In the model we are constructing they have collected information about the way people left dumbbells as a part of their exercise routine using various movement coordinate variables. The lifting of the dumbbell is then classified into 5 factors (or Classes)  namely 
(i)	The correct method (Class A)
(ii)	throwing the elbows to the front (Class B), 
(iii)	lifting the dumbbell only halfway (Class C),
(iv)	lowering the dumbbell only halfway (Class D) 
(v)	throwing the hips to the front (Class E). 

Read more: http://groupware.les.inf.puc-rio.br/har#ixzz3gxdJ2qD2 
</p>
<strong><u>Preprocessing of the data:</u></strong>
</p>
In order to begin with the data analysis we start by loading the required libraries and then loading the given datasets.

</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">###Loading libraries</span>
<span class="hl kwd">library</span><span class="hl std">(caret)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'caret' was built under R version 3.2.1
</pre></div>
<div class="message"><pre class="knitr r">## Loading required package: lattice
## Loading required package: ggplot2
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'ggplot2' was built under R version 3.2.1
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(randomForest)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'randomForest' was built under R version 3.2.1
</pre></div>
<div class="message"><pre class="knitr r">## randomForest 4.6-10
## Type rfNews() to see new features/changes/bug fixes.
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(rpart)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'rpart' was built under R version 3.2.1
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(rpart.plot)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: package 'rpart.plot' was built under R version 3.2.1
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">###Reading in the datasets</span>

<span class="hl std">modeldata</span><span class="hl kwb">&lt;-</span><span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;pml-training.csv&quot;</span><span class="hl std">,</span><span class="hl kwc">na.strings</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;NA&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;&quot;</span><span class="hl std">))</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in file(file, &quot;rt&quot;): cannot open file 'pml-training.csv': No such
## file or directory
</pre></div>
<div class="error"><pre class="knitr r">## Error in file(file, &quot;rt&quot;): cannot open the connection
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">modeldataTest</span><span class="hl kwb">&lt;-</span><span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;pml-testing.csv&quot;</span><span class="hl std">,</span><span class="hl kwc">na.strings</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;NA&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;&quot;</span><span class="hl std">))</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in file(file, &quot;rt&quot;): cannot open file 'pml-testing.csv': No such
## file or directory
</pre></div>
<div class="error"><pre class="knitr r">## Error in file(file, &quot;rt&quot;): cannot open the connection
</pre></div>
</div></div>

<p>Then we clean the datasets by reducing the number of unwanted variables. We get rid of those which consists of mostly missing values and also eliminate certain numeric variables like date timestamp which do not add much value to this particular predictive model.</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">###Cleaning the dataset to remove unwanted variables and thereby improving computing efficiency</span>
<span class="hl kwd">summary</span><span class="hl std">(modeldata)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in summary(modeldata): object 'modeldata' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">summary</span><span class="hl std">(modeldata</span><span class="hl opt">$</span><span class="hl std">classe)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in summary(modeldata$classe): object 'modeldata' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">###Removing variables which has missing values for all the rows</span>
<span class="hl std">rm_var</span> <span class="hl kwb">=</span> <span class="hl kwd">sapply</span><span class="hl std">(Training2,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span><span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(x))})</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in lapply(X = X, FUN = FUN, ...): object 'Training2' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">table</span><span class="hl std">(rm_var)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in table(rm_var): object 'rm_var' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">rm_columns</span> <span class="hl kwb">=</span> <span class="hl kwd">names</span><span class="hl std">(rm_var[rm_var</span><span class="hl opt">==</span><span class="hl num">13436</span><span class="hl std">])</span> <span class="hl com">###100 of the columns have 13436 rows with missing values - this was the result of the table function</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'rm_var' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">Training2</span> <span class="hl kwb">=</span> <span class="hl std">Training2[,</span> <span class="hl opt">!</span><span class="hl kwd">names</span><span class="hl std">(Training2)</span> <span class="hl opt">%in%</span> <span class="hl std">rm_columns]</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'Training2' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(Training2)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in str(Training2): object 'Training2' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">###Removing other unwanted numeric variables such as timestamp</span>

<span class="hl std">Training2</span><span class="hl kwb">&lt;-</span><span class="hl std">Training2[</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl opt">-</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl opt">-</span><span class="hl num">4</span><span class="hl std">,</span><span class="hl opt">-</span><span class="hl num">5</span><span class="hl std">)]</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'Training2' not found
</pre></div>
</div></div>
<p>
<strong><u>Cross Validation of the data:</u></strong>
We split up the given cleaned dataset into testing and training sets and use a 70:30 split, in order to cross validate our predictive model.
</p>
<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">###Partitioning the Training dataset into 70% training and 30% testing sets</span>
<span class="hl std">inTrain</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">createDataPartition</span><span class="hl std">(</span><span class="hl kwc">y</span><span class="hl std">=modeldata</span><span class="hl opt">$</span><span class="hl std">classe,</span> <span class="hl kwc">p</span><span class="hl std">=</span><span class="hl num">0.7</span><span class="hl std">,</span> <span class="hl kwc">list</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in createDataPartition(y = modeldata$classe, p = 0.7, list = FALSE): object 'modeldata' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">Training2</span> <span class="hl kwb">&lt;-</span> <span class="hl std">modeldata[inTrain, ]</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'modeldata' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">Testing2</span> <span class="hl kwb">&lt;-</span> <span class="hl std">modeldata[</span><span class="hl opt">-</span><span class="hl std">inTrain, ]</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'modeldata' not found
</pre></div>
</div></div>
<strong><u>Predictive Models: </u></strong>
<p>We now use Random Forest and Decision Trees machine leaning algorithms to predict the class of the weight lift depending on the various accelerometer readings.</p>
<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">###Predicting using ML packages</span>
<span class="hl com">###Decision Trees</span>
<span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">333</span><span class="hl std">)</span>
<span class="hl std">modelfitDT</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rpart</span><span class="hl std">(classe</span> <span class="hl opt">~</span> <span class="hl std">.,</span> <span class="hl kwc">data</span><span class="hl std">=Training2,</span> <span class="hl kwc">method</span><span class="hl std">=</span><span class="hl str">&quot;class&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in is.data.frame(data): object 'Training2' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">rpart.plot</span><span class="hl std">(modelfitDT)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in inherits(x, &quot;rpart&quot;): object 'modelfitDT' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">predictDT</span><span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modelfitDT,Testing2,</span><span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;class&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in predict(modelfitDT, Testing2, type = &quot;class&quot;): object 'modelfitDT' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">confusionMatrix</span><span class="hl std">(predictDT, Testing2</span><span class="hl opt">$</span><span class="hl std">classe)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in confusionMatrix(predictDT, Testing2$classe): object 'predictDT' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">###Random Forests - with cross validation</span>
<span class="hl std">modelfitRF</span><span class="hl kwb">&lt;-</span><span class="hl kwd">train</span><span class="hl std">(Training2</span><span class="hl opt">$</span><span class="hl std">classe</span> <span class="hl opt">~</span> <span class="hl std">.,</span> <span class="hl kwc">method</span><span class="hl std">=</span><span class="hl str">&quot;rf&quot;</span><span class="hl std">,</span> <span class="hl kwc">trControl</span><span class="hl std">=</span><span class="hl kwd">trainControl</span><span class="hl std">(</span><span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">&quot;cv&quot;</span><span class="hl std">,</span> <span class="hl kwc">number</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">),</span> <span class="hl kwc">data</span><span class="hl std">=Training2)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'Training2' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">print</span><span class="hl std">(modelfitRF,</span> <span class="hl kwc">digits</span><span class="hl std">=</span><span class="hl num">3</span><span class="hl std">)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in print(modelfitRF, digits = 3): object 'modelfitRF' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">predictRF</span><span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modelfitRF,</span><span class="hl kwc">newdata</span> <span class="hl std">= Testing2)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in predict(modelfitRF, newdata = Testing2): object 'modelfitRF' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">confusionMatrix</span><span class="hl std">(predictRF, Testing2</span><span class="hl opt">$</span><span class="hl std">classe)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in confusionMatrix(predictRF, Testing2$classe): object 'predictRF' not found
</pre></div>
</div></div>
<p>Here is the plot of the decision tree. <p>
<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">rpart.plot</span><span class="hl std">(modelfitDT)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in inherits(x, &quot;rpart&quot;): object 'modelfitDT' not found
</pre></div>
</div></div>

<p>The results using the Decision tree (Rpart) algorithm
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1504  101    0   13    6
         B   40  842   71   86   56
         C   22   77  849   48    6
         D   96   65   99  730   82
         E   12   54    7   87  932

Overall Statistics
                                          
               Accuracy : 0.8253          
                 95% CI : (0.8154, 0.8349)
    No Information Rate : 0.2845          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.7794          
 Mcnemar's Test P-Value : < 2.2e-16       

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.8984   0.7392   0.8275   0.7573   0.8614
Specificity            0.9715   0.9467   0.9685   0.9305   0.9667
Pos Pred Value         0.9261   0.7689   0.8473   0.6810   0.8535
Neg Pred Value         0.9601   0.9380   0.9638   0.9514   0.9687
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
Detection Rate         0.2556   0.1431   0.1443   0.1240   0.1584
Detection Prevalence   0.2760   0.1861   0.1703   0.1822   0.1856
Balanced Accuracy      0.9350   0.8430   0.8980   0.8439   0.9140

The results using the Random Forest algorithm

Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1673    2    0    0    0
         B    0 1136    1    0    0
         C    0    1 1025    5    0
         D    0    0    0  959    3
         E    1    0    0    0 1079

Overall Statistics
                                          
               Accuracy : 0.9978          
                 95% CI : (0.9962, 0.9988)
    No Information Rate : 0.2845          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.9972          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9994   0.9974   0.9990   0.9948   0.9972
Specificity            0.9995   0.9998   0.9988   0.9994   0.9998
Pos Pred Value         0.9988   0.9991   0.9942   0.9969   0.9991
Neg Pred Value         0.9998   0.9994   0.9998   0.9990   0.9994
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
Detection Rate         0.2843   0.1930   0.1742   0.1630   0.1833
Detection Prevalence   0.2846   0.1932   0.1752   0.1635   0.1835
Balanced Accuracy      0.9995   0.9986   0.9989   0.9971   0.9985
<p>
<p>
Since the Random Forest yileds a higher accuracy we'll be using the same for predicting on the final test set.
<p>
<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">predictFinal</span><span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modelfitRF,</span><span class="hl kwc">newdata</span> <span class="hl std">= modeldataTest)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in predict(modelfitRF, newdata = modeldataTest): object 'modelfitRF' not found
</pre></div>
</div></div>
<p>The script for submitting the Final Assignment.<p>
<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">pml_write_files</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">){</span>
  <span class="hl std">n</span> <span class="hl kwb">=</span> <span class="hl kwd">length</span><span class="hl std">(x)</span>
  <span class="hl kwa">for</span><span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl std">n){</span>
    <span class="hl std">filename</span> <span class="hl kwb">=</span> <span class="hl kwd">paste0</span><span class="hl std">(</span><span class="hl str">&quot;problem_id_&quot;</span><span class="hl std">,i,</span><span class="hl str">&quot;.txt&quot;</span><span class="hl std">)</span>
    <span class="hl kwd">write.table</span><span class="hl std">(x[i],</span><span class="hl kwc">file</span><span class="hl std">=filename,</span><span class="hl kwc">quote</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">row.names</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl kwc">col.names</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">)</span>
  <span class="hl std">}</span>
<span class="hl std">}</span>

<span class="hl kwd">pml_write_files</span><span class="hl std">(predictFinal)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in pml_write_files(predictFinal): object 'predictFinal' not found
</pre></div>
</div></div>
</body>
</html>
